# 問題生成アプリ 開発要件定義書

## 1. プロジェクト概要
- **目的**: 学習テキストからAI（Gemini/GPT）を用いて「選択式クイズ」を自動生成し、内容の校正・管理を行うための管理者専用Webツール。
- **フェーズ**: プロトタイプ開発（バックエンド/DBは含まず、フロントエンドでのモック動作に徹する）。
- **ターゲットデバイス**: MacBook Pro 14inch（デスクトップブラウザの広い画面を活かしたUI）。
- **作成場所**: `/Users/kuwa/Develop/personal/LearnLoop/`
- **技術スタック**:
    - **Framework**: Next.js (App Router)
    - **Styling**: Tailwind CSS
    - **UI Components**: shadcn/ui (Radix UIベース)
    - **Animation**: Framer Motion
    - **Icons**: Lucide React

---

## 2. コア機能要件

### 2.1 テキスト入力画面（Generate Screen）
- **カテゴリ選択**: 既存のドロップダウン選択、または自由入力（Docker, ネットワーク, 英語など）の両方をサポート。
- **ソース入力**: 大容量のテキスト（Markdown含む）をペーストできる高機能テキストエリア。
- **生成アクション**: 「問題を生成」ボタン。
    - 入力バリデーション（例：200文字以下はボタン非活性）を実装。
    - 生成中はAIが思考しているようなスケルトン表示やローディングアニメーションを提供。

### 2.2 問題プレビュー・編集画面（Preview Screen）
- **カードリスト形式**: 生成された複数の問題を縦スクロールリストで表示。
- **詳細表示・編集**: 
    - 各カード内で「問題文」「選択肢（正解/不正解フラグ）」「解説」を直接インライン編集可能にする。
    - 選択肢の追加・削除、正解の切り替えを直感的に行えるUI。
- **削除機能**: 不適切な問題をリストから即座に除外。Framer Motionによるスムーズなリスト移動アニメーションを付与。
- **保存アクション**: 「保存」ボタン押下時は、現在の全問題データをクリアし、トップ（生成画面）へ戻る（完了トーストを表示）。

### 2.3 モックロジック
- **擬似生成**: 実際のAPIは使用せず、`setTimeout` を利用して数秒待機した後、`lib/mocks` に定義したダミーJSONデータをステートにセットする。

---

## 3. アーキテクチャ・実装方針

### 3.1 開発ガイドライン（Flutter/Compose エンジニア向け）
- **日本語コメントの徹底**: 
    - ロジックに詳細な日本語コメントを付与。当たり前すぎることは書かなくていい。
    - 「React特有の概念」や「Web標準の挙動（イベントバブリング等）」など、モバイル開発との相違点を重点的に補足する。
- **概念の比較**: 
    - `useState` → `ValueNotifier` / `mutableStateOf`
    - `useEffect` → `initState` / `LaunchedEffect`
    - `.map()` によるリストレンダリング → `ListView.builder` 
    などの比較注釈をコード内に含める。

### 3.2 フォルダ・ファイル構成
拡張性と可読性を重視し、責務を明確に分けた「Feature-based」構成を採用する。

- `src/app/`: ルーティングと各ページの定義。
- `src/features/admin/`: Admin機能のメインロジック。
    - `/components/`: 生成フォーム、問題カード、プレビューリスト。
    - `/hooks/`: **ロジック分離のためのカスタムフック**（Flutterの `ViewModel` や `ChangeNotifier` 相当）。
    - `/types/`: TypeScriptによる型定義。
- `src/components/ui/`: shadcn/ui等の汎用UIコンポーネント。
- `src/lib/`: ユーティリティ関数およびモックデータ。

### 3.3 デザイン・UI/UX
- **継承**: `learn-loop-ui-design` のデザインシステム（配色、角丸、余白感）を継承し、Tailwind CSSの変数として定義する。learn-loop-ui-design/components/adminに問題生成とプレビュー画面のモックがあるのでこのデザインをベースに実装してほしい。
- **操作感**: 
    - ボタンのホバー、クリック時のスケール変化など、リッチなフィードバックを実装。
    - デスクトップならではのショートカット（例：`Cmd + Enter` で生成）の検討。

---

## 4. 開発の進め方
1. **Design System & Types**: 色、フォント、および問題データの型（Interface）を定義。
2. **Mock Layer**: AI生成を模倣する非同期関数を実装。
3. **Generate UI**: テキスト入力・バリデーション画面の実装。
4. **Preview UI**: リスト表示・インライン編集・アニメーション削除の実装。
5. **Flow Integration**: 全体の画面遷移とデータリセットの結合。

## 5. 補足
flutter, jetpack composeの開発には精通しているが、Web開発およびReactは初心者であるため、それを考慮した上でやり取りしてほしい。
