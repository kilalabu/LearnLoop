# 学習自動化システム 仕様要件書
Notion等のソースからAIが問題を自動生成し、忘却曲線に基づいた復習を強制的に行う自分専用学習システムの仕様。
---

## 1. システム概要
- **目的**: インプットした情報の定着率を最大化するため、AIによる問題生成と、忘却曲線に基づいた強制的なアウトプット環境を構築する。
- **ターゲット**: 個人利用（自分専用）。
- **運用コスト**: 各種サービスの無料枠内（Supabase, AI APIの低価格ティア等）で運用する。
---

## 2. インプット（コンテンツ作成）仕様

### 2.1 ソース連携
- **Phase 1 (MVP)**: 
    - **手動入力**: 適当に作った管理画面から、テキストまたはMarkdown形式の文章を直接ペーストして入力し、問題と解答解説をAIに生成させる。
    問題が良さそうであればDBに保存する。
- **Phase 2以降**: 
    - **Notion連携**: Notionデータベース内のページ内容（Markdown）をスキャン。
    - **外部URL**: ウェブページのURLから内容を抽出。

### 2.2 問題生成ロジック
- **使用モデル**: 無料範囲で利用できそうなモデル
- **生成内容**: 読み込んだテキストの「重要なポイント」を抽出し、クイズ化する。
- **問題数**: 1つのテキストから複数の問題を生成（AIが重要度に応じて判断）。
- **問題形式**: 
  - 全て「複数選択式（チェックボックス）」とする。
  - 正誤判定は「完全一致」のみを正解とする。
- **問題の管理**: 
  - 問題にはIDを付与し、Supabase上で永続的に保持する。

---

## 3. 出題・学習ロジック仕様

### 3.1 出題スケジュール
- **朝（07:00）**: 最大10問。
- **昼（12:00）**: 最大5問。
- **夜（19:00）**: 最大10問。
- **時間指定**: 初期段階はシステム固定。

### 3.2 復習アルゴリズム
- **構成**: 「新しい問題」＋「忘却曲線に基づいた復習問題」をセットで出題。
- **復習間隔（1st）**: 固定スケジュール（例：1, 3, 7, 14, 30日後）。
- **繰り越し**: 指定の時間に解けなかった問題は、次の時間帯のセッションに合算（蓄積）される。
- **関連性**: 同一ソースから生成された問題は、可能な限り同じセッションでまとめて出題する。

---

## 4. アプリケーション（Flutter）仕様

### 4.1 学習体験
- **解答フロー**: 問題表示 → 選択 → 回答確認 → 即座に正解・不正解と解説を表示。
- **参照リンク**: 解説画面に、元のソースへのリンク（または引用テキスト）を表示。

### 4.2 メンテナンス（2nd以降検討）
- **二度と出さないボタン**: 押下された問題は、以降の出題スケジュールから除外（非表示フラグを更新）。

### 4.3 通知・強制力（2nd以降検討）
- **リマインド**: プッシュ通知による告知。
- **アプリロック**: 
  - 問題を解き終えるまで、特定のアプリ（SNS等）の起動を制限する。
  - ロック解除条件は「そのセッションの出題分をすべて解き終えること」。

---

## 5. 運用・管理仕様

### 5.1 データ管理
- **保存先**: **Supabase**（PostgreSQL）を使用。
- **保持データ**: 
  - `problems`: 問題文、選択肢、正解、解説、ソース元情報、ジャンル。
  - `user_progress`: 正誤履歴、最終回答日、現在の忘却ステップ、次回出題予定日。

### 5.2 インフラ構成
- **Frontend**: Flutter
- **DB**: Supabase (Database, Auth)
- **Backend**: Ktor or Supabase (Edge Functions)
- **AI**: Gemini API / OpenAI API

---

## 6. フェーズ別ロードマップ

### Phase 1 (MVP)
- **入力**: アプリ内管理画面からのテキストペースト機能。
- **AI生成**: Gemini 1.5 Flash等による複数選択式クイズ生成。
- **DB**: Supabaseへの問題保存と学習履歴の記録。
- **学習UI**: 固定スケジュールでの出題および解答・解説画面。
- **ロジック**: 固定間隔（1, 3, 7...日後）による復習スケジューリング。

### Phase 2
- **Notion連携**: データベースからの自動同期バッチ。
- **アプリロック**: 特定アプリの起動制限機能（Android優先）。
- **動的調整**: ユーザーの正誤履歴に応じた復習間隔の動的調整。
- **チャット修正**: AIへの問題修正依頼機能。

### Phase 3
- **URL抽出**: ウェブサイトからのスクレイピング生成。
- **可視化**: 学習進捗のグラフ表示、ジャンル別分析。
