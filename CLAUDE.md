# CLAUDE.md

## コミュニケーション

- 日本語で応答する

## エージェント使い分けルール

**重要: 組み込みの Explore / Plan エージェントおよび EnterPlanMode は使用しない。以下のカスタムサブエージェントを使用すること。**
**理由: サブエージェントはメインコンテキストを消費せず、プロジェクト知識が内蔵されており、コスト効率が良い。**

| タスク | エージェント | モデル | 備考 |
|:---|:---|:---|:---|
| コード調査・探索 | `codebase-explorer` | sonnet | 変更前の影響調査に積極的に使う |
| 実装計画 | `implementation-planner` | inherit | 複数ステップの実装タスク時 |
| コード実装 | `code-implementer` | sonnet | プランの各ステップを直列実行 |
| UI/UXデザイン | `ui-designer` | inherit | UI新規作成・改修の前にデザインを検討 |
| テスト作成 | `test-writer` | sonnet | 機能実装・バグ修正後に積極的に使う |
| バグ調査 | `bug-investigator` | sonnet | ログ・スタックトレースから原因特定 |

### 計画→実装フロー（コスト最適化）
1. `codebase-explorer` (sonnet) で調査 — 調査の大量トークン消費を安価なモデルで処理
2. 調査結果を `implementation-planner` (Opus) に渡してプラン作成 — 高品質な設計判断のみ Opus で実行
3. プランをユーザーに提示して承認を得る
4. 承認後、プランの各ステップを `code-implementer` (sonnet) に直列で委譲 — Opus はステップの指示出しのみ
5. ロジックのテストは `test-writer` (sonnet) に委譲 — 実装と並列実行可（UI非依存のため）

## ユーザーのスキルセット

- Flutter / Jetpack Compose に精通、Backend開発・React は初心者
- **learn-loop-studio（Next.js / TypeScript）の改修時は解説を丁寧にする**
  - 何をしているか・なぜそうするかを日本語コメントで補足（自明なものは不要）
  - 「React特有の概念」や「Web標準の挙動（イベントバブリング等）」など、モバイル開発との相違点は重点的に説明する
- learn_loop_app（Flutter）側は簡潔でよい

## コーディング規約

- TypeScript / Dart ともに既存コードのスタイルに従う
- 新規ファイルの配置は既存のディレクトリ構成に合わせる
- コミットメッセージは日本語で簡潔に

## やってはいけないこと

- 既存のアーキテクチャパターンを無断で変更しない
- 不要なライブラリを追加しない（既存の依存で解決できないか先に確認）
- `.env` や認証情報を含むファイルをコミットしない
